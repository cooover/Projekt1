#create database wytwornia_plytowa;
#use wytwornia_plytowa;
#drop table sprzedaz;
#drop table albumy;
#drop table zespoly;
#drop table opiekun;
create table opiekun (id_g int not null auto_increment, gatunek text not null, imie_o text, nazwisko text, ilosc_zespolow int not null, primary key (id_g));
create table zespoly (id_z int not null auto_increment, nazwa_z text not null, id_g int not null, ilosc_a int not null, primary key (id_z), foreign key (id_g) references opiekun(id_g));
create table albumy (id_a int not null auto_increment, nazwa_a text not null, id_z int not null, data_wydania date, primary key (id_a), foreign key (id_z) references zespoly (id_z)); 
create table sprzedaz (id_s int not null auto_increment, plytyCD int, plyty_gram int, s_cyfrowa int, id_a int, primary key (id_s), foreign key (id_a) references albumy (id_a));
create trigger dodanie_zespolu after insert on zespoly for each row update opiekun set ilosc_zespolow = ilosc_zespolow + 1 where opiekun.id_g = new.id_g;
create trigger usuniecie_zespolu after delete on zespoly for each row update opiekun set ilosc_zespolow = ilosc_zespolow - 1 where opiekun.id_g = old.id_g;
create trigger dodanie_albumu after insert on albumy for each row update zespoly set ilosc_a = ilosc_a + 1 where zespoly.id_z = new.id_z;
create trigger usuniecie_albumu after delete on albumy for each row update zespoly set ilosc_a = ilosc_a - 1 where zespoly.id_z = old.id_z;
insert into opiekun values (null, 'jazz', 'Jan', 'Kowalski', 0);
insert into opiekun values (null, 'muzyka elektroniczna', 'Anna', 'Nowak', 0);
insert into opiekun values (null, 'rock', 'Adam', 'Kowalski', 0);
insert into opiekun values (null, 'pop', 'Wojciech', 'Zawadzki', 0);
insert into opiekun values (null, 'disco polo', 'Piotr', 'Wisniewski', 0);
insert into opiekun values (null, 'hip-hop', 'Zofia', 'Jastrzebska', 0);
insert into opiekun values (null, 'metal', 'Katarzyna', 'Misiak', 0);
insert into opiekun values (null, 'techno', 'Marta', 'Groszewska', 0);
insert into opiekun values (null, 'country', 'Maciej', 'Kujawa', 0);
insert into opiekun values (null, 'blues', 'Wojciech', 'Brzozowski', 0);
insert into opiekun values (null, 'reggae', 'Pawel', 'Krajewski', 0);
insert into opiekun values (null, 'muzyka instrumentalna', 'Anna', 'Osinska', 0);
insert into opiekun values (null, 'folk', 'Grzegorz', 'Gajewski', 0);
insert into opiekun values (null, 'new-wave', 'Agnieszka', 'Pietrzak', 0);
insert into opiekun values (null, 'muzyka alternatywna', 'Aleksandra', 'Osik', 0);
insert into opiekun values (null, 'trip-hop', 'Paulina', 'Grzybowska', 0); 
insert into opiekun values (null, 'muzyka niezalezna', 'Andrzej', 'Kruk', 0);
select * from opiekun;
insert into zespoly values (null, 'Emancipator', 2, 0);
insert into zespoly values (null, 'Twin Shadow', 14, 0);
insert into zespoly values (null, 'Archive', 15, 0);
insert into zespoly values (null, 'Flunk', 16, 0);
insert into zespoly values (null, 'Massive Attack', 16, 0);
insert into zespoly values (null, 'Royksopp', 2, 0);
insert into zespoly values (null, 'Regina Spector', 17, 0);
insert into zespoly values (null, 'Parov Stelar', 2, 0);
insert into zespoly values (null, 'Sonata Arctica', 7, 0);
insert into zespoly values (null, 'Kings of Leon', 3, 0);
insert into zespoly values (null, 'Evergrey', 7, 0);
insert into zespoly values (null, 'Yeasayes', 17, 0);
insert into zespoly values (null, 'Olafur Arnalds', 12, 0);
insert into zespoly values (null, 'Muse', 3, 0);
insert into zespoly values (null, 'In Flames', 7, 0);
insert into zespoly values (null, 'Lao Che', 3, 0);
insert into zespoly values (null, 'M83', 2, 0);
insert into zespoly values (null, 'Razorlight', 15, 0);
insert into zespoly values (null, 'Michael Jackson', 4, 0);
insert into zespoly values (null, 'Frnz Ferdinand', 17, 0);
insert into zespoly values (null, 'Arctic Monkeys', 17, 0);
insert into zespoly values (null, 'Stateless', 16, 0);
insert into zespoly values (null, 'The Streets', 6, 0);
insert into zespoly values (null, 'The Libertines', 15, 0);
insert into zespoly values (null, 'Th Black Keys', 10, 0);
insert into zespoly values (null, 'Datarock', 2, 0);
insert into zespoly values (null, 'Dry the River', 13, 0);
insert into zespoly values (null, 'I Blame Coco', 4, 0);
insert into zespoly values (null, 'Queens of the Stone Age', 3, 0);
insert into zespoly values (null, 'Firewind', 7, 0);
insert into zespoly values (null, 'Matisyahu', 11, 0);
insert into zespoly values (null, 'Chromeo', 2, 0);
insert into zespoly values (null, 'Zbigniew Preisner', 12, 0);
insert into zespoly values (null, 'Hurts', 14, 0);
insert into zespoly values (null, 'Tricky', 16, 0);
insert into zespoly values (null, 'Brodka', 4, 0);
insert into zespoly values (null, 'Michal Urbaniak', 1, 0);
insert into zespoly values (null, 'Leszek Mozdzer', 1, 0);
insert into zespoly values (null, 'Boys', 5, 0);
insert into zespoly values (null, 'Moderat', 8, 0);
select * from zespoly;
insert into albumy values (null, 'Far', 7, '2009-05-08');
insert into albumy values (null, 'Begin to Hope', 7, '2006-06-10');
insert into albumy values (null, 'Dusk to dawn', 1, '2013-01-29');
insert into albumy values (null, 'Mezzanine', 5, '1998-04-17');
insert into albumy values (null, 'Blue Lines', 5, '1991-04-08');
insert into albumy values (null, 'Heligoland', 5, '2010-02-05');
insert into albumy values (null, 'A Grand Dont Come for Free', 23, '2004-05-10');
insert into albumy values (null, 'Computers and Blues', 23, '2011-02-04');
insert into albumy values (null, 'Spark Seeker', 31, '2012-07-17');
insert into albumy values (null, 'Happiness - Deluxe Edition', 34, '2011-10-28');
insert into albumy values (null, 'Confess', 2, '2012-06-22');
insert into albumy values (null, 'Winterhearts Guild', 9, '2003-02-21');
insert into albumy values (null, 'You All Look the Same to Me', 3, '2002-09-16');
insert into albumy values (null, 'You Could Have It So Much Better', 20, '2005-09-28');
insert into albumy values (null, 'Come Clarity', 15, '2006-02-07');
insert into albumy values (null, 'Absolution', 14, '2003-09-21');
insert into albumy values (null, 'Melody A.M.', 6, '2001-10-08');
insert into albumy values (null, 'Coco', 8, '2009-09-14');
insert into albumy values (null, 'Found Songs', 13, '2009-04-19');
insert into albumy values (null, 'Junior', 6, '2009-03-18');
insert into albumy values (null, 'Recreation Day', 11, '2003-03-11');
insert into albumy values (null, 'Origin of Symmetry', 14, '2001-06-15');
insert into albumy values (null, 'Rough Cuts', 8, '2004-10-25');
insert into albumy values (null, 'The Inner Circle', 11, '2004-04-26');
insert into albumy values (null, 'Allegiance', 30, '2006-07-24');
insert into albumy values (null, 'White Women', 32, '2014-05-12');
insert into albumy values (null, 'Granda', 36, '2010-09-17');
insert into albumy values (null, 'AM', 21, '2013-09-09');
insert into albumy values (null, 'O.K.', 39, '1997-07-01');
insert into albumy values (null, 'Whatever People Say I Am, Thats What Im Not', 21, '2006-01-23');
insert into albumy values (null, 'Shallow Bed', 27, '2012-03-12');
insert into albumy values (null, 'Red', 26, '2009-07-22');
insert into albumy values (null, 'Clashes', 36, '2016-05-13');
insert into albumy values (null, 'II', 40, '2013-07-29');
insert into albumy values (null, 'Morning Star',4 , '2004-04-27');
insert into albumy values (null, 'The Constant', 28, '2010-11-08');
insert into albumy values (null, 'Piano', 38, '2004-06-14');
insert into albumy values (null, 'The Libertines', 24,'2004-08-30');
insert into albumy values (null, 'Songs for the Deaf', 29, '2002-08-17');
insert into albumy values (null, 'El Camino', 25, '2011-10-11');
insert into albumy values (null, 'Brothers', 25, '2010-05-14');
insert into albumy values (null, 'Matilda', 22, '2011-02-21');
insert into albumy values (null, 'Saturdays = Youth', 17, '2008-04-10');
insert into albumy values (null, 'Only by the Night', 10, '2008-09-19');
insert into albumy values (null, 'UrbSymphony', 37, '2003-01-01');
insert into albumy values (null, 'Gospel', 16, '2008-02-22');
insert into albumy values (null, 'Knowle West Boy', 35, '2008-07-05');
insert into albumy values (null, 'Bad', 19, '1987-08-31');
insert into albumy values (null, 'Odd Blood', 12, '2010-02-08');
insert into albumy values (null, 'Powstanie Warszawskie', 16, '2005-03-21');
insert into albumy values (null, 'All Hour Cymbals', 12, '2007-10-23');
insert into albumy values (null, 'Thriller', 19, '1982-11-30');
insert into albumy values (null, 'Dzieciom', 16, '2015-03-06');
insert into albumy values (null, 'Moje koledy na koniec wieku', 33, '1999-12-24');
insert into albumy values (null, 'Slipway Fires', 18, '2008-11-03');
insert into albumy values (null, 'Razorlight', 18, '2006-07-17');
select * from zespoly order by ilosc_a desc;
insert into sprzedaz values (null, 24273, 4567, 53728, 28);
insert into sprzedaz values (null, 75839, 15879, 742903, 31);
insert into sprzedaz values (null, 78457, 52355, 620973, 6);
insert into sprzedaz values (null, 478903, 64789, 732586, 23);
insert into sprzedaz values (null, 37469, 24440, 414525, 33);
insert into sprzedaz values (null, 432583, 4329, 526347, 38);
insert into sprzedaz values (null, 63257, 6389, 527290, 1);
insert into sprzedaz values (null, 383649, 4134, 421213, 53);
insert into sprzedaz values (null, 264373, 3883, 317678, 11);
insert into sprzedaz values (null, 346539, 78932, 734290, 13);
insert into sprzedaz values (null, 468909, 27369, 894269, 22);
insert into sprzedaz values (null, 429769, 14879, 761900, 5);
insert into sprzedaz values (null, 897572, 295765, 998775, 52);
insert into sprzedaz values (null, 46880, 41321, 354123, 37);
insert into sprzedaz values (null, 62890, 42918, 746254, 12);
insert into sprzedaz values (null, 23344, 2341, 73342, 30);
insert into sprzedaz values (null, 54399, 43299, 545223, 20);
insert into sprzedaz values (null, 47299, 29348, 284269, 43);
insert into sprzedaz values (null, 46788, 7820, 324790, 54);
insert into sprzedaz values (null, 56778, 28, 962363, 29);
insert into sprzedaz values (null, 35279, 6389, 124789, 49);
insert into sprzedaz values (null, 67579, 758, 768908, 24);
insert into sprzedaz values (null, 474286, 42736, 586578, 18);
insert into sprzedaz values (null, 47382, 4393, 427523, 41);
insert into sprzedaz values (null, 89425, 2895, 926542, 9);
insert into sprzedaz values (null, 573829, 6430, 836437, 39);
insert into sprzedaz values (null, 45789, 4378, 672567, 8);
insert into sprzedaz values (null, 47800, 4256, 131457, 3);
insert into sprzedaz values (null, 46899, 7230, 364293, 56);
insert into sprzedaz values (null, 946189, 429793, 947236, 48);
insert into sprzedaz values (null, 47582, 4289, 427875, 47);
insert into sprzedaz values (null, 432526, 63746, 627289, 27);
insert into sprzedaz values (null, 46278, 4682, 134345, 42);
insert into sprzedaz values (null, 48769, 8344, 897690, 16);
insert into sprzedaz values (null, 445294, 4125, 525212, 21); 
insert into sprzedaz values (null, 318690, 37219, 632819, 17);
insert into sprzedaz values (null, 65530, 3356, 420344, 34);
insert into sprzedaz values (null, 46589, 3145, 145521, 46);
insert into sprzedaz values (null, 76429, 42038, 283677, 45);
insert into sprzedaz values (null, 42456, 25644, 256214, 35);
insert into sprzedaz values (null, 74588, 3429, 428743, 51);
insert into sprzedaz values (null, 14456, 1234, 125480, 36); 
insert into sprzedaz values (null, 247283, 43267, 627648, 7);
insert into sprzedaz values (null, 56634, 3249, 492930, 32); 
insert into sprzedaz values (null, 63629, 4789, 625793, 2);
insert into sprzedaz values (null, 428183, 42521, 854327, 44);
insert into sprzedaz values (null, 74187, 43290, 423769, 19);
insert into sprzedaz values (null, 74618, 1414, 415132, 50);
insert into sprzedaz values (null, 468293, 4145, 523524, 25);
insert into sprzedaz values (null, 47293,4892, 90476, 40);
insert into sprzedaz values (null, 42890, 4739, 52810, 55);
insert into sprzedaz values (null, 342451, 52523, 521242, 14);
insert into sprzedaz values (null, 524792, 25242, 423522, 10);
insert into sprzedaz values (null, 849763, 42890, 981940, 4);
insert into sprzedaz values (null, 849179, 3445, 952358, 15);
insert into sprzedaz values (null, 52957, 42525, 525665, 26);
# wyswietla albumy uporzadkowane od najwiekszej ilosci sprzedanych
select zespoly.nazwa_z, albumy.nazwa_a, (plytyCD +plyty_gram+s_cyfrowa) as ilosc from sprzedaz, zespoly, albumy where albumy.id_a = sprzedaz.id_a and zespoly.id_z = albumy.id_z order by ilosc desc;